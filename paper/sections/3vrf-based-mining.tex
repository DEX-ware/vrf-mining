\section{VRF-based mining}

\subsection{Our construction}

We replace hash function in mining by VRF, and thus construct VRF-based mining.

To rule out pooled mining, we combine VRF with digital signature scheme.
As the digital signature scheme use in cryptocurrency are based on Elliptic curve, we construct Elliptic curve based VRF for our VRF-based mining.
The standardised construction is put in the appendix~\ref{vrf_standardised_construction}.

% The desired properties of a well-designed hash function includes uniformity, deterministic, unpredictability and verifiability.
% As shown in appendix~\ref{vrf_standardised_construction}, ...
% Therefore, VRF fits in here.

In the case of solo mining, our sheme works as follows.

\TODO{change format to algorithm2e}
% https://www.overleaf.com/learn/latex/algorithms
\begin{enumerate}
    \item The solo miner runs $\mathsf{VRFKeyGen}(1^{\lambda})$ to generate a secret key and public key pair $(sk, pk)$.
    \item The miner query the the full node it runs, and build a block template, including a coinbase transaction paying to him, for example, to his \texttt{scriptPubKey}.
    \item The miner alters the nonce in the block header.
    \item The miner takes the block header as $\alpha$, and runs $\mathsf{VRFHash}(sk, \alpha)$ to get $\beta$. If $\beta$ meets the difficulty requirement, a block is found; otherwise, the miner changes the nonce and runs $\mathsf{VRFHash}(sk, \alpha)$ again.
    \item The miner runs $\mathsf{VRFProve}(sk, \alpha)$ to generate a proof $\pi$.
    \item The miner then submit the $pk$, $\beta$, and the proof $\pi$ to the node.
    \item The node then check:
        \begin{enumerate}
            \item if $\beta$ meets the difficulty requirement;
            \item if $\mathsf{VRFVerify}(pk, \alpha, \beta, \pi)$ result is valid;
            \item whether the \texttt{scriptPubKey} in the coinbase transaction corresponds to $pk$.
        \end{enumerate}
        If all results are valid, a new block is mined, and the coinbase reward is paid to the miner.
    \item $pk$, $\beta$ and $\pi$ should also be recorded in the block header, so that, when the block is propogated to other nodes, they can easily validate it via $\mathsf{VRFVerify}(pk, \alpha, \beta, \pi)$.
\end{enumerate}

\subsection{Why pooled mining cannot work in our scheme}

% need private key
As shown in appendix~\ref{vrf_standardised_construction}, both $\mathsf{VRFHash}$ and $\mathsf{VRFProve}$ take secret key $sk$ as input.
That is to say, if a pool operator would like to provide pooled mining service and let miners participate, he will need to provide miners with his secret key.

% none would like to provide private key
However, none rational pool operator will tend to give out his secret key, as others can use his secret key to spend his balance or forge his identity.

Therefore, following our construction, we eliminate the intentionality of pooled mining and can reduce the centralisation of mining power significanlty.
